niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.3))#,list(mu=c(0.5,4),sigma=c(1,1),p=0.3),list(mu=c(6,1),sigma=c(1,1),p=0.3),list(mu=c(5,6.5),sigma=c(1,1),p=0.3))
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.3))
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.3))#,list(mu=c(0.5,4),sigma=c(1,1),p=0.3),list(mu=c(6,1),sigma=c(1,1),p=0.3),list(mu=c(5,6.5),sigma=c(1,1),p=0.3))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.3),list(mu=c(0.5,4),sigma=c(1,1),p=0.3),list(mu=c(6,1),sigma=c(1,1),p=0.3),list(mu=c(5,6.5),sigma=c(1,1),p=0.3))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.3)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(1,1),p=0.3),list(mu=c(5,6.5),sigma=c(1,1),p=0.3))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.3)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
params0 <- params0[[2]]
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
run=1
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
run=2
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
params0 <- list(mu=c(0.5,4),sigma=c(1,1),p=0.5)
#--------------------------
params_mat <- matrix(unlist(params0),ncol=5,nrow = 1)
ll_vec =c(logLikelihood(params0,y))
#-------------------------
delta = 10
iter = 0
params =  params0
N <- length(y)
print(iter)
iter = iter + 1
#------------- E step
rho1 = params$p*dnorm(y,params$mu[1],params$sigma[1])
rho2 = (1-params$p)*dnorm(y,params$mu[2],params$sigma[2])
tau = rho1/(rho1 + rho2)
#----------------- M step
N1 = sum(tau)
N2 =  N-N1
mu_new <- c(0,0)
mu_new[1] <- sum(tau*y)/N1
mu_new[2] <- sum((1-tau)*y)/N2
if(!estim_only_mu){
sigma_new <- c(0,0)
sigma_new[1] <- 1/N1*sum(tau*(y-mu_new[1])^2)
sigma_new[2] <- 1/N2*sum((1-tau)*(y-mu_new[2])^2)
p_new <- mean(tau)
}
#---------- delta
delta = sum((params$mu-mu_new)^2)
#----------------- LL evaluation
params$mu <- mu_new
if(!estim_only_mu){
params$sigma <- sigma_new
params$p <- p_new
}
ll_vec = c(ll_vec,logLikelihood(params,y))
params_mat <- rbind(params_mat,unlist(params))
ll_vec
#--------------------------
params_mat <- matrix(unlist(params0),ncol=5,nrow = 1)
ll_vec =c(logLikelihood(params0,y))
#-------------------------
delta = 10
iter = 0
params =  params0
N <- length(y)
while (delta > tol){
print(iter)
iter = iter + 1
#------------- E step
rho1 = params$p*dnorm(y,params$mu[1],params$sigma[1])
rho2 = (1-params$p)*dnorm(y,params$mu[2],params$sigma[2])
tau = rho1/(rho1 + rho2)
#----------------- M step
N1 = sum(tau)
N2 =  N-N1
mu_new <- c(0,0)
mu_new[1] <- sum(tau*y)/N1
mu_new[2] <- sum((1-tau)*y)/N2
if(!estim_only_mu){
sigma_new <- c(0,0)
sigma_new[1] <- 1/N1*sum(tau*(y-mu_new[1])^2)
sigma_new[2] <- 1/N2*sum((1-tau)*(y-mu_new[2])^2)
p_new <- mean(tau)
}
#---------- delta
delta = sum((params$mu-mu_new)^2)
#----------------- LL evaluation
params$mu <- mu_new
if(!estim_only_mu){
params$sigma <- sigma_new
params$p <- p_new
}
ll_vec = c(ll_vec,logLikelihood(params,y))
params_mat <- rbind(params_mat,unlist(params))
}
params_mat
estim_only_mu=FALSE
#--------------------------
params_mat <- matrix(unlist(params0),ncol=5,nrow = 1)
ll_vec =c(logLikelihood(params0,y))
#-------------------------
delta = 10
iter = 0
params =  params0
N <- length(y)
while (delta > tol){
print(iter)
iter = iter + 1
#------------- E step
rho1 = params$p*dnorm(y,params$mu[1],params$sigma[1])
rho2 = (1-params$p)*dnorm(y,params$mu[2],params$sigma[2])
tau = rho1/(rho1 + rho2)
#----------------- M step
N1 = sum(tau)
N2 =  N-N1
mu_new <- c(0,0)
mu_new[1] <- sum(tau*y)/N1
mu_new[2] <- sum((1-tau)*y)/N2
if(!estim_only_mu){
sigma_new <- c(0,0)
sigma_new[1] <- 1/N1*sum(tau*(y-mu_new[1])^2)
sigma_new[2] <- 1/N2*sum((1-tau)*(y-mu_new[2])^2)
p_new <- mean(tau)
}
#---------- delta
delta = sum((params$mu-mu_new)^2)
#----------------- LL evaluation
params$mu <- mu_new
if(!estim_only_mu){
params$sigma <- sigma_new
params$p <- p_new
}
ll_vec = c(ll_vec,logLikelihood(params,y))
params_mat <- rbind(params_mat,unlist(params))
}
params
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
params$p*dnorm(y,params$mu[1],params$sigma[1])
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
if (tau==0) {tau=0.001}
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
tau
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
if (sum(tau)==0) {tau=rep(0.001,N)}
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
#--------------------------
params_mat <- matrix(unlist(params0),ncol=5,nrow = 1)
ll_vec =c(logLikelihood(params0,y))
#-------------------------
delta = 10
iter = 0
params =  params0
N <- length(y)
while (delta > tol){
print(iter)
iter = iter + 1
#------------- E step
rho1 = params$p*dnorm(y,params$mu[1],params$sigma[1])
rho2 = (1-params$p)*dnorm(y,params$mu[2],params$sigma[2])
tau = rho1/(rho1 + rho2)
if (sum(tau)==0) {tau=rep(0.001,N)}
#----------------- M step
N1 = sum(tau)
N2 =  N-N1
mu_new <- c(0,0)
mu_new[1] <- sum(tau*y)/N1
mu_new[2] <- sum((1-tau)*y)/N2
if(!estim_only_mu){
sigma_new <- c(0,0)
sigma_new[1] <- 1/N1*sum(tau*(y-mu_new[1])^2)
sigma_new[2] <- 1/N2*sum((1-tau)*(y-mu_new[2])^2)
p_new <- mean(tau)
}
#---------- delta
delta = sum((params$mu-mu_new)^2)
#----------------- LL evaluation
params$mu <- mu_new
if(!estim_only_mu){
params$sigma <- sigma_new
params$p <- p_new
}
ll_vec = c(ll_vec,logLikelihood(params,y))
params_mat <- rbind(params_mat,unlist(params))
}
params_mat <- as.data.frame(params_mat)
params_mat[,6] = ll_vec
names(params_mat) = c('mu1','mu2','sigma1','sigma2','p','loglik')
rownames(params_mat) = 1:nrow(params_mat)
return(params_mat)
params_mat
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-5},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c('init',rep('iter',nrow(res_EM_run)-1)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run$loglik
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = run)) + geom_line()
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:row(res_EM_run))
names(res_EM_run)[7]='Init'
res_EM_run <- cbind(res_EM_run, c(1:row(res_EM_run)))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
ggplot(res_all_run_all,aes(x=,y=loglik,colour = run)) + geom_line()
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = run)) + geom_line()
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = as.factor(run))) + geom_line()
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line()
res_all_run_all
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line()
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
source("~/WORK_ALL/RECHERCHE/LIVRE/LivreLatentVariableModels/LatentVarEcolEvol/Codes/ToyExemple2Mixture/EM_mu.R")
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line()
library(dplyr)
res_all_run_all <- res_all_run_all %>% select(numIter>10)
res_all_run_all
res_all_run_all <- res_all_run_all %>% filter(numIter>10)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line()
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line()
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point()
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
#------------ PLOT ------------------
res_all_run$Init <- as.factor(res_all_run$Init)
res_all_run$numIter <- as.factor(res_all_run$numIter)
true_mu <- as.data.frame(matrix(params_true$mu,nrow=1))
names(true_mu)  =c('mu1','mu2')
gg <- ggplot(res_like,aes(x=mu1,y=mu2,z=loglik)) + geom_tile(aes(fill=loglik)) + scale_fill_viridis() + stat_contour(color="white", size=0.25)
gg <- gg + geom_point(data=res_all_run, aes(x=mu1, y=mu2,z=NULL,colour=Init,shape=numIter),size=3) + geom_line(data=res_all_run, aes(x=mu1, y=mu2,z=NULL,col=Init)) + scale_shape_manual(values=c(15, 20))
gg <- gg + geom_point(data=true_mu, aes(x=mu1, y=mu2,z=NULL),size=4,color='black')
gg + guides(shape="none") + labs(x=expression(mu[1]),y=expression(mu[2]))
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all <- res_all_run_all %>% filter(numIter>5)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all <- res_all_run_all %>% filter(numIter>1)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>1)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>1)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
#params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
#params0[[5]] = list(mu=c(6,6),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(4,4),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(4,4),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(4,4),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
res_all_run_all <- res_all_run_all %>% filter(numIter>2)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(4,4),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.4)
params0 = list(list(mu=c(1,2),sigma=c(1,1),p=0.5),list(mu=c(0.5,4),sigma=c(1,1),p=0.5),list(mu=c(6,1),sigma=c(2,2),p=0.5),list(mu=c(5,6.5),sigma=c(2,2),p=0.5))
params0[[5]] = list(mu=c(4,4),sigma=c(1,1),p=0.5)
res_all_run_all <-do.call(rbind,lapply(1:length(params0),function(run){
res_EM_run  <- EM_2Mixture(params0[[run]],y,tol=10^{-7},estim_only_mu = FALSE)
niter <- nrow(res_EM_run)
res_EM_run <- cbind(res_EM_run,rep(run,niter))
res_EM_run <- cbind(res_EM_run, c(1:nrow(res_EM_run)))
names(res_EM_run)[7]='Init'
names(res_EM_run)[8]='numIter'
return(res_EM_run)}))
res_all_run_all$Init <- as.factor(res_all_run_all$Init)
res_all_run_all <- res_all_run_all %>% filter(numIter>3)
ggplot(res_all_run_all,aes(x=numIter,y=loglik,colour = Init)) + geom_line() + geom_point(size=0.4)
